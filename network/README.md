## 네트워크

### 웹 통신의 흐름

1. 사용자가 웹 브라우저를 통해 URL을 입력한다.
2. 입력된 URL의 도메인 네임을 DNS 서버에서 검색한다.
3. URL 정보와 DNS 서버로부터 전달받은 IP 주소를 통해 HTTP Request Message를 생성한다.
4. TCP를 통해 서버에 요청한다.
5. 서버는 클라이언트의 요청에 맞는 HTTP Response를 전송한다.

### Nginx

웹 서버의 일종이며 컴퓨터의 정적 리소스(html, css, javascript, image) 등을 클라이언트에게 제공하며, 리버스 프록시를 통해 서버 보안이 가능하고, 로드 밸런싱, 캐싱 기능을 제공한다.

nginx는 이벤트 드리븐 방식으로 작동되어 아파치 등 타 웹 서버보다 성능이 중요시 될 때 사용한다.

event-driven : 시간이 오래 걸리는 요청들을 따로 수행하는 쓰레드 풀을 만들었다. worker process는 cpu의 코어 수만큼 생성되고, cpu의 context-switching 사용을 줄일 수 있게 하는 구조.

리버스 프록시 : 서버가 클라이언트에게 자신의 서버 정보를 숨기기 위해 사용한다.

로드 밸런싱 : nginx에 여러 대의 서버가 연결되었을 때 균등하게 요청을 분배한다.

프록시 캐싱 : 클라이언트 요청을 받아 백엔드 서버로 전달하기 전에 응답을 캐싱하는 방식이다. 동일한 응답일 경우 다시 생성하지 않고 캐시 된 응답을 반환하여 서버의 부하를 줄일 수 있다.

#### Master Process

설정 파일을 읽고 설정 파일에 맞는 worker process를 생성하는 작업을 한다.

#### Worker Process

실제 요청을 처리하는 작업을 한다.

### HTTPS

HTTPS는 HTTP에 보안 소켓 레이어가 추가된 것이다. 클라이언트와 서버는 핸드쉐이크를 통해 서버는 인증서를 보내고 클라이언트는 그 인증서를 브라우저에 내장된 인증 기관인 CA에 보내 등록된 인증서인지 확인한다.

클라이언트는 인증 후 사이트의 정보와 서버의 공개 키를 얻게 되고, 이 공개 키로 통신에 사용할 세션 키를 보낸다. 서버는 받은 세션 키를 개인 키로 복호화해 확인하고 이후의 통신은 방금 받은 세션 키를 대칭 키 방식으로 암복호화하여 사용한다.

비대칭 키 방식이 있는데 왜 굳이 복잡하게 핸드쉐이크 후 공개 키로 세션 키를 만들어 서버에 보내고 그것을 복호화하는 과정을 통해 가면서 대칭 키 방식으로 사용하냐면, 비대칭 키 방식은 컴퓨터에 부하가 많이 가기 때문이다.

### REST

URI를 통해 자원을 표시하고 HTTP Method를 이용해 해당 자원의 행위를 정해 주며, 그 결과를 받는 것을 의미한다.

#### 특징

1. 유니폼 인터페이스
   표준만 따른다면 어떤 언어 혹은 어떤 플랫폼에서 사용하여도 사용이 가능하다.
2. 무상태성
   상태 정보를 유지하지 않는다.
   서버는 각각의 요청을 완전히 다른 것으로 인식하고 처리한다.
   이전 요청이 다음 요청 처리에 연관되지 않는다.
3. 캐시 가능
   HTTP의 기존 웹 표준을 사용하기 때문에 캐싱 기능을 적용할 수 있다.
4. 클라이언트 - 서버 구조
   서버는 API를 제공하고 클라이언트는 사용자 인증 등을 직접 관리하는 구조로 각각의 역할이 확실히 구분되어 클라이언트와 서버의 역할이 명확하고, 서로 간의 의존성이 줄어든다.
   자원이 있는 곳을 server, 자원을 요청하는 곳이 client가 된다.
5. 자체 표현 구조
   REST API 메시지만 보고도 쉽게 이해가 가능한 자체 표현 구조로 되어 있다.
6. 계층형 구조
   다중 계층으로 구성하여 API 서버는 비즈니스 로직만 처리하고 프록시나 게이트웨이 같은 네트워크 중간 매체를 통해 보안, 로드 밸런싱, 암호화 계층을 따로 둘 수 있다.
